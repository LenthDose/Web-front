{"remainingRequest":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\src\\views\\order\\addReservation.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\src\\views\\order\\addReservation.vue","mtime":1638605739609},{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\css-loader\\dist\\cjs.js","mtime":1638098760125},{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1638098761912},{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\postcss-loader\\src\\index.js","mtime":1638098760921},{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1638098759177},{"path":"C:\\Users\\Silhouette76\\Desktop\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1638098761214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmVsLWZvcm17DQogIHdpZHRoOiA0MCU7DQogIG1hcmdpbi1sZWZ0OiAzMHB4Ow0KICBtYXJnaW4tdG9wOiAzMHB4Ow0KfQ0K"},{"version":3,"sources":["addReservation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoQA;AACA;AACA;AACA;AACA","file":"addReservation.vue","sourceRoot":"src/views/order","sourcesContent":["<template lang=\"\">\r\n  <div>\r\n    <el-form\r\n      ref=\"reservation\"\r\n      :model=\"reservation\"\r\n      label-width=\"80px\"\r\n      :inline=\"true\"\r\n    >\r\n      <el-form-item label=\"预定人\">\r\n        <el-input v-model=\"reservation.ordername\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"联系电话\">\r\n        <el-input v-model=\"reservation.orderphone\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"身份证号\">\r\n        <el-input v-model=\"reservation.orderidcard\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"入住时间\">\r\n        <el-col :span=\"11\">\r\n          <el-date-picker\r\n            v-model=\"reservation.arriredate\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择日期\"\r\n            style=\"width: 190%\"\r\n            default-time=\"12:00:00\"\r\n            format=\"yyyy-MM-dd HH:mm:ss\"\r\n            value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n          />\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"退房时间\">\r\n        <el-col :span=\"11\">\r\n          <el-date-picker\r\n            v-model=\"reservation.leavedate\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择日期\"\r\n            style=\"width: 190%\"\r\n            default-time=\"12:00:00\"\r\n            format=\"yyyy-MM-dd HH:mm:ss\"\r\n            value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n            @change=\"calTime\"\r\n          />\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"入住天数\">\r\n        <el-input v-model=\"reservation.staysday\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"入住人数\">\r\n        <el-input v-model=\"reservation.checknum\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"预定房号\">\r\n        <el-input v-model=\"reservation.roomid\" />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"show\">选 择</el-button>\r\n      </el-form-item>\r\n      <el-form-item label=\"客房类型\">\r\n        <el-input v-model=\"reservation.typename\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"客房价格\">\r\n        <el-input v-model=\"reservation.price\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"折扣类型\">\r\n        <el-select\r\n          v-model=\"reservation.discount\"\r\n          placeholder=\"请选择\"\r\n          style=\"width: 93%\"\r\n          @change=\"cal\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in discount\"\r\n            :key=\"item.value\"\r\n            :label=\"item.discountreason\"\r\n            :value=\"item.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"入住价格\">\r\n        <el-input v-model=\"reservation.checkprice\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"备注\">\r\n        <el-input v-model=\"reservation.remark\" />\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <el-button type=\"primary\" style=\"margin-left:50px\" @click=\"onSubmit\">立即创建</el-button>\r\n    <el-dialog :title=\"dialogTitle\" width=\"50%\" :visible.sync=\"iconFormVisible\">\r\n      <el-form :inline=\"true\" :model=\"roomwrappers\">\r\n        <el-form-item label=\"楼层类型\">\r\n          <el-select v-model=\"roomwrappers.floortype\" placeholder=\"请选择\" @change=\"getType(roomwrappers.floortype)\">\r\n            <el-option\r\n              v-for=\"item in floortypes\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.label\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"客房类型\">\r\n          <el-select v-model=\"roomwrappers.typename\" placeholder=\"请选择\" @change=\"getList()\">\r\n            <el-option\r\n              v-for=\"item in typenames\"\r\n              :key=\"item.typeid\"\r\n              :label=\"item.typename\"\r\n              :value=\"item.typename\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <el-table\r\n        :data=\"tableData\"\r\n        border\r\n      >\r\n        <el-table-column\r\n          prop=\"typeid\"\r\n          label=\"房型编号\"\r\n        />\r\n        <el-table-column\r\n          prop=\"roomid\"\r\n          label=\"客房编号\"\r\n        />\r\n        <el-table-column\r\n          prop=\"typename\"\r\n          label=\"客房类型\"\r\n        />\r\n        <el-table-column\r\n          prop=\"floortype\"\r\n          label=\"楼层类型\"\r\n        />\r\n        <el-table-column\r\n          prop=\"status\"\r\n          label=\"状态\"\r\n        />\r\n        <el-table-column>\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              size=\"mini\"\r\n              @click=\"handleEdit(scope.$index, scope.row)\"\r\n            >选择</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { getRoomType, getRoomListWithWrapper, getRoomInfoList, getPrice } from '@/api/room'\r\nimport { getDiscount, addOne } from '@/api/reservation'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      floortypes: [\r\n        { value: 1, label: '标准楼层' },\r\n        { value: 2, label: '贵宾楼层' },\r\n        { value: 3, label: '桂冠楼层' },\r\n        { value: 4, label: '总统套房' }\r\n      ],\r\n      roomtypes: [],\r\n      reservation: {\r\n        ordername: '',\r\n        orderphone: '',\r\n        arriredate: '',\r\n        leavedate: '',\r\n        price: '',\r\n        orderstate: '未办理入住',\r\n        discountreason: '',\r\n        discount: '',\r\n        checkprice: '',\r\n        ischeck: '否',\r\n        remark: '',\r\n        operatorid: this.$store.getters.id,\r\n        staysday: '',\r\n        typename: ''\r\n      },\r\n      tableData: [{}],\r\n      roomwrappers: {\r\n        floortype: '',\r\n        typename: '',\r\n        status: '空闲'\r\n      },\r\n      typenames: [\r\n      ],\r\n      dialogTitle: '客房信息',\r\n      iconFormVisible: false,\r\n      rowIndex: null,\r\n      discount: [{}]\r\n    }\r\n  },\r\n  mounted() {\r\n    getDiscount().then(res => {\r\n      this.discount = res.data\r\n    })\r\n  },\r\n  methods: {\r\n    getType(val) {\r\n      getRoomType(val).then(response => {\r\n        this.typenames = response.data\r\n      })\r\n    },\r\n    onSubmit() {\r\n      addOne(this.reservation).then(res => {\r\n        if (res.code === 200) {\r\n          this.$notify({\r\n            title: res.data,\r\n            type: 'success'\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: res.data,\r\n            type: 'error'\r\n          })\r\n        }\r\n      })\r\n      this.$refs['reservation'].resetFields()\r\n    },\r\n    show() {\r\n      this.iconFormVisible = true\r\n      getRoomInfoList().then(response => {\r\n        this.tableData = response.data.data\r\n      })\r\n    },\r\n    handleEdit(index, row) {\r\n      this.reservation.roomid = row.roomid\r\n      this.reservation.typename = row.typename\r\n      this.reservation.typeid = row.typeid\r\n      this.iconFormVisible = false\r\n      getPrice(row.floortype, row.typename).then(res => {\r\n        this.reservation.price = res.data\r\n      })\r\n    },\r\n    getList() {\r\n      getRoomListWithWrapper(this.roomwrappers.floortype,\r\n        this.roomwrappers.typename, this.roomwrappers.status).then(\r\n        res => {\r\n          this.tableData = res.data\r\n        }\r\n      )\r\n    },\r\n    cal(val) {\r\n      if (val) {\r\n        let obj = {}\r\n        obj = this.discount.find((item) => {\r\n          return item.value === val\r\n        })\r\n        this.reservation.discountreason = obj.discountreason\r\n        this.reservation.checkprice = parseFloat(val) * parseInt(this.reservation.price, 10)\r\n      }\r\n    },\r\n    calTime() {\r\n      const stime = this.reservation.arriredate\r\n      const etime = this.reservation.leavedate\r\n      const usedTime = Date.parse(etime) - Date.parse(stime)\r\n      const days = Math.floor(usedTime / (24 * 3600 * 1000))\r\n      this.reservation.staysday = days\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"css\">\r\n.el-form{\r\n  width: 40%;\r\n  margin-left: 30px;\r\n  margin-top: 30px;\r\n}\r\n</style>\r\n"]}]}